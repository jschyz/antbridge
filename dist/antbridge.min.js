/*!
 * antbridge.js v1.1.4
 * (c) 2017-2017 huihui
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ant=t()}(this,function(){"use strict";function e(e){e=e.split(".");for(var t=O.split("."),n=0,r=void 0,o=void 0;n<t.length;n++){if(r=parseInt(e[n],10)||0,o=parseInt(t[n],10)||0,r>o)return-1;if(r<o)return 1}return 0}function t(e){return"[object String]"===U.call(e)}function n(e){return"[object Number]"===U.call(e)}function r(e,t){for(var n in t)e[n]=t[n];return e}function o(){return J}function i(){var e=[].slice.call(arguments),n=e[0],r=e[1]||{};return t(n)?J.then(function(){return new Promise(function(e,t){window.AlipayJSBridge.call(n,r,function(n){n.error?t(n):e(n)})})}):Promise.reject({error:1,errorMessage:"\u63a5\u53e3\u4e0d\u5b58\u5728"})}function a(e,t){e.split(/\s+/g).forEach(function(e){N[e]||(N[e]=[]),N[e].push(t),document.addEventListener(e,t,!1)})}function s(e){var t;for(N[e]||(N[e]=[]);void 0!==(t=N[e].shift());)document.removeEventListener(e,t,!1)}function c(e,n){return t(e)&&(e={url:e}),e=e||{},e.url?i("pushWindow",e):(console.error("Ali.pushWindow: url is required\uff01"),!1)}function u(e,t){return i("popWindow",e)}function l(e,r){return n(e)?e={step:e}:t(e)&&(e={urlPattern:e}),void 0!==e.step&&(e.index=e.step),i("popTo",e)}function d(e){e=e||{};var t={format:"jpg",dataType:"dataurl",quality:50,allowEdit:!1,src:void 0,cameraType:void 0,maskImg:void 0,maskWidth:void 0,maskHeight:void 0};return r(t,e),t.imageFormat=t.format,"remoteurl"===t.dataType&&(t.dataType="dataurl"),t.dataType=t.dataType.slice(0,-3)+t.dataType.slice(-3).toUpperCase(),i("photo",t).then(function(e){return e.dataURL&&(e.dataURL="data:image/"+t.imageFormat+";base64,"+e.dataURL),e.photo=e.dataURL||e.fileURL,e},function(e){return e.errorMessage=10===e.error?"\u7528\u6237\u53d6\u6d88":e.errorMessage,e})}function p(e){var t={1:"Weixin",2:"Weibo",4:"SMS",8:"LaiwangContacts",16:"LaiwangTimeline",32:"WeixinTimeLine",64:"CopyLink"};e=e||{};var n=e;if(e.channels&&0!==e.channels.length)E&&e.channels.forEach(function(e){"qzone"===e.name.toLowerCase()&&(e.name="QQZone")});else{e.title=e.title||"",e.content=e.text,e.imageUrl=e.image,e.captureScreen=!!e.captureScreen,e.url=e.url||"",n={channels:[]},"undefined"==typeof e.shareType&&(e.shareType=-1);for(var r in t)Number(r)&e.shareType&&n.channels.push({name:t[r],param:e})}return i("share",n)}function f(){return i("login")}function h(e,t){return i("tradePay",e)}function g(e){return console.error("alpayClient don't support Ali.h5TradePay\uff0cplease use Ali.tradePay"),o().then(function(){return{errorCode:1,errorMessage:"\u63a5\u53e3\u4e0d\u5b58\u5728"}})}function m(e){return(t(e)||n(e))&&(e={message:e+""}),i("alert",e)}function y(e){return(t(e)||n(e))&&(e={message:e+""}),i("confirm",e)}function w(e,t){return E&&("undefined"!=typeof e.title&&""!==e.title||(e.title=" ")),i("actionSheet",e)}function v(e,n){return t(e)&&(e={url:e}),i("openInBrowser",e)}function T(e){return(t(e)||n(e))&&(e={text:e+""}),e=e||{},e.content=e.text,e.duration=e.duration||2e3,i("toast",e)}function b(e){var n={type:"title"};return t(e)&&(e={title:e}),e.title=e.title||e.text,r(n,e),null===n.title?(console.error("setTitle: title is required\uff01"),!1):i("setTitle",n)}function A(){return i("showTitlebar")}function S(){return i("hideTitlebar")}function L(e){return(t(e)||n(e))&&(e={text:e+""}),e=e||{},i("showLoading",e)}function k(e){return i("hideLoading")}function C(e){return o().then(function(){return P=window.AlipayJSBridge.startupParams})}var P,B=Object.create({}),W=navigator.userAgent,x="1.1.4",M=W.indexOf("AlipayClient")>-1||W.indexOf("AliApp(AP")>-1,I=W.indexOf("Nebula")>-1,O=function(){if(M){var e=W.match(/AlipayClient\/(.*)/);return e&&e.length?e[1]:""}return""}(),j={engine:"alipay",engineVer:O,name:"alipay",ver:O},E=/android/i.test(W),D=/iphone|ipad/i.test(W),R=Object.freeze({ua:W,version:x,isAlipay:M,isNebula:I,alipayVersion:O,appinfo:j,isAndroid:E,isIOS:D,compareVersion:e}),U=Object.prototype.toString,J=new Promise(function(e){window.AlipayJSBridge&&window.AlipayJSBridge.call?e():document.addEventListener("AlipayJSBridgeReady",e)}),N={},q=Object.freeze({ready:o,call:i,_listener:N,on:a,off:s}),z={add:function(e){return i("addEventCal",e)}},G={vibrate:function(e){return n(e)&&(e={duration:e}),i("vibrate",e)}},V={watch:function(e){return i("watchShake",e)}},F={getCurrentPosition:function(e){return e=e||{timeout:15e3},Promise.race([i("getLocation").then(function(e){return e.coords={},e.coords.latitude=+e.latitude,e.coords.longitude=+e.longitude,e.city=e.city?e.city:e.province,e.cityCode=e.citycode,e.address=e.pois,e}),new Promise(function(t,n){setTimeout(function(){console.error("geolocation.getCurrentPosition: timeout"),n({errorCode:5,errorMessage:"\u8c03\u7528\u8d85\u65f6"})},e.timeout)})])}},H={get:function(e,t){return e=e||{},e.multiple&&console.error("\u4ec5\u652f\u6301\u5355\u9009"),i("contact",e).then(function(e){return e.results=[],e.results[0]={phoneNumber:e.mobile,email:void 0,name:e.name},e},function(e){switch(e.errorCode){case 10:e.errorMessage="\u6ca1\u6709\u6743\u9650";break;case 11:e.errorMessage="\u7528\u6237\u53d6\u6d88\u64cd\u4f5c"}return e})}},Q={getType:function(e){return e=e||{timeout:15e3},Promise.race([i("getNetworkType").then(function(e){return e.networkAvailable="fail"!==e.networkType,e.is3G=e.is2G=e.isE=e.isG=e.isH=!1,e.isWifi="wifi"===e.networkType,e.isOnline=e.networkAvailable,e.type=e.networkType,e}),new Promise(function(t,n){setTimeout(function(){console.error("network.getType: timeout"),n({errorCode:5,errorMessage:"\u8c03\u7528\u8d85\u65f6"})},e.timeout)})])}},Z=Object.freeze({pushWindow:c,popWindow:u,popTo:l,calendar:z,photo:d,vibration:G,shake:V,geolocation:F,share:p,contacts:H,network:Q,login:f,tradePay:h,h5TradePay:g,alert:m,confirm:y,actionSheet:w,openInBrowser:v,toast:T,setTitle:b,showTitle:A,hideTitle:S,showLoading:L,hideLoading:k,get launchParams(){return P},getLaunchParams:C});return r(B,R),r(B,q),r(B,Z),["startApp","showOptionMenu","hideOptionMenu","showToolbar","hideToolbar","closeWebview","sendSMS","scan","getSessionData","setSessionData","checkJSAPI","checkApp","isInstalledApp","deposit","chooseContact","alipayContact","getConfig","getCities","rsa","getWifiList","connectWifi","notifyWifiShared","thirdPartyAuth","getThirdPartyAuthcode","setToolbarMenu","exitApp","hideBackButton","startApp","startPackage","getSharedData","setSharedData","removeSharedData","setClipboard","startDownload","stopDownload","getDownloadInfo","detectBeacons","startBeaconsBeep","stopBeaconsBeep","startIndoorLocation","stopIndoorLocation","addEventCal","startSpeech","stopSpeech","cancelSpeech","getWifiInfo","clearAllCookie","getMtopToken","getClientInfo","sinasso","getClipboard","checkBLEAvalability","scanBeacons","isSpeechAvailable","speechRecognizer","contactSync","setGestureBack","remoteLog","httpRequest","rpc","ping","snapshot","imageViewer","upload","networkAnalysis","showTitleLoading","hideTitleLoading","getLocation"].forEach(function(e){B[e]=function(){var t=Array.from(arguments);B.call.apply(null,[e].concat(t))}}),B});